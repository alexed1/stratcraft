<aura:component implements="flexipage:availableForAllPageTypes, force:appHostable" access="global" controller="StrategyCrafterController">

    <ltng:require scripts="{!$Resource.utils}" />
    <ltng:require scripts="{!$Resource.force}" />

    
    <aura:attribute name="curStratCopy" type="Strategy" />
    <aura:attribute name="curStrat" type="Strategy" />
    <aura:attribute name="curStratNode" type="Object" />
    <aura:attribute name="treeItems" type="Object" />
    <aura:attribute name="originalNode" type="Object" />

    <aura:attribute name="strategyNames" type="List" />
    <aura:attribute name="selectedStrategyName" type="String" default="" />

    <!--this holds record data loaded from the salesforce Strategy record. We convert it to our curStrat representation
    -->
    <aura:attribute name="strategyRecord" type="Object" />
    <!--deprecated. replace with strategyRecord.strategyXML -->
    <aura:attribute name="strategyXML" type="String" />


    <aura:handler name="init" value="{!this}" action="{!c.init}" />


    <aura:handler name="xmlFileUploaded" event="c:XMLFileUploaded" action="{!c.processLoadedXMLString}" />
    <aura:handler event="c:propertyPageSaveRequestEvent" action="{!c.saveStrategy}" />
    <aura:handler event="c:treeNodeSelectedEvent" action="{!c.handleTreeNodeSelect }" />

    <aura:registerEvent name="xmlFileUploaded" type="c:XMLFileUploaded" />
    
    <div class="slds-card slds-p-around_small">


        <lightning:spinner aura:id="mySpinner" class="slds-hide" size="large" />

        <lightning:overlayLibrary aura:id="unsavedChangesDialog" />


        <!-- <div> 
            <lightning:icon iconName="standard:hierarchy" size="medium" alternativeText="Strategy"/>
            
        </div>
    -->

        <div class="heading">Einstein Next Strategy Builder 
        </div>

        <div class="slds-float_left slds-m-top_large">
            
                <lightning:buttonMenu iconName="utility:settings" alternativeText="Settings" onselect="{! c.handleMenuSelect }">

                    <lightning:menuItem label="Save Strategy" value="save"/>
                   
                </lightning:buttonMenu>
         </div>
         <div class="slds-float_left slds-m-top_xxx-small slds-m-left_small">       
     
                <lightning:select name="strategySelect" label="Select a strategy:" aura:id="mySelect" value="{!v.selectedStrategyName}" class="select_box" onchange="{!c.handleStrategySelection}">>

                <aura:iteration items="{!v.strategyNames}" var="item">
                    <option text="{!item}" value="{!item}" />
                </aura:iteration>
            </lightning:select>






        </div>
        <p></p>
        <hr class="myhr"></hr>

        <!-- <div aura:id="fileInput" ondragover="{!c.onDragOver}" ondrop="{!c.onDrop}" >Drop Here!</div> -->
        <br> </br>


        <div class="slds-grid ">


            <div class="slds-col slds-box slds-size_1-of-3">
                <c:treeNode aura:id="tree" treeItems="{! v.treeItems }" header="NodeTree"/>
            </div>

            <div class="slds-col slds-box">
                <b>Node Properties</b>
                {!v.body}                
                <c:BasePropertyPage aura:id="propertyPage"/>

            </div>

        </div>
    </div>

</aura:component>